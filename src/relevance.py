# -*- coding: utf-8 -*-
"""Relevance.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1BQxQ0uPubeCDAm6dDihKIosi0OOEgDI1
"""

from google.colab import drive
drive.mount('/content/gdrive')

import numpy as np
import pandas as pd

df0 = pd.read_csv('/content/gdrive/My Drive/player_stats/2010_player.csv')
df1 = pd.read_csv('/content/gdrive/My Drive/player_stats/2011_player.csv')
df2 = pd.read_csv('/content/gdrive/My Drive/player_stats/2012_player.csv')
df3 = pd.read_csv('/content/gdrive/My Drive/player_stats/2013_player.csv')
df4 = pd.read_csv('/content/gdrive/My Drive/player_stats/2014_player.csv')
df5 = pd.read_csv('/content/gdrive/My Drive/player_stats/2015_player.csv')
df6 = pd.read_csv('/content/gdrive/My Drive/player_stats/2016_player.csv')
df7 = pd.read_csv('/content/gdrive/My Drive/player_stats/2017_player.csv')
df8 = pd.read_csv('/content/gdrive/My Drive/player_stats/2018_player.csv')

df0

df9 = pd.DataFrame(df0)

df9 = df9.append(df1)
df9 = df9.append(df2)

df9 = df9.append(df3)
df9 = df9.append(df4)
df9 = df9.append(df5)
df9 = df9.append(df6)
df9 = df9.append(df7)
df9 = df9.append(df8)

df9.shape

arr = np.array(df9['Name'].unique())
arr

df_final = pd.DataFrame(data=arr,columns=['Players'])

df_final.shape

df_final['post_2010_hard_hit'] = np.nan
df_final['post_2010_bat_consistency'] = np.nan
df_final['post_2010_pca_bat'] = np.nan
df_final['post_2010_Bowl_index'] = np.nan
df_final['post_2010_bowl_consistency'] = np.nan
df_final['post_2010_bowl_pca'] = np.nan
for ind in df0.index :
  for ind2 in df_final.index :
    if(df_final['Players'][ind2]==df0['Name'][ind]):
      df_final['post_2010_hard_hit'][ind2] = df0['hard_hit'][ind]
      df_final['post_2010_bat_consistency'][ind2] = df0['bat_consistency'][ind]
      df_final['post_2010_pca_bat'][ind2] = df0['pca_bat'][ind]
      df_final['post_2010_Bowl_index'][ind2] = df0['Bowl_index'][ind]
      df_final['post_2010_bowl_consistency'][ind2] = df0['bowl_consistency'][ind]
      df_final['post_2010_bowl_pca'][ind2] = df0['bowl_pca'][ind]
      break

df_final = df_final.fillna(0)

df_final

df_final['post_2011_hard_hit'] = np.nan
df_final['post_2011_bat_consistency'] = np.nan
df_final['post_2011_pca_bat'] = np.nan
df_final['post_2011_Bowl_index'] = np.nan
df_final['post_2011_bowl_consistency'] = np.nan
df_final['post_2011_bowl_pca'] = np.nan
for ind in df1.index :
  for ind2 in df_final.index :
    if(df_final['Players'][ind2]==df1['Name'][ind]):
      df_final['post_2011_hard_hit'][ind2] = 0.6*df1['hard_hit'][ind] + 0.4*df_final['post_2010_hard_hit'][ind2]
      df_final['post_2011_bat_consistency'][ind2] = 0.6*df1['bat_consistency'][ind] + 0.4*df_final['post_2010_bat_consistency'][ind2]
      df_final['post_2011_pca_bat'][ind2] = 0.6*df1['pca_bat'][ind] + 0.4*df_final['post_2010_pca_bat'][ind2]
      df_final['post_2011_Bowl_index'][ind2] = 0.6*df1['Bowl_index'][ind] + 0.4*df_final['post_2010_Bowl_index'][ind2]
      df_final['post_2011_bowl_consistency'][ind2] = 0.6*df1['bowl_consistency'][ind] + 0.4*df_final['post_2010_bowl_consistency'][ind2]
      df_final['post_2011_bowl_pca'][ind2] = 0.6*df1['bowl_pca'][ind] + 0.4*df_final['post_2010_bowl_pca'][ind2]
      break

df_final = df_final.fillna(0)

df_final['post_2012_hard_hit'] = np.nan
df_final['post_2012_bat_consistency'] = np.nan
df_final['post_2012_pca_bat'] = np.nan
df_final['post_2012_Bowl_index'] = np.nan
df_final['post_2012_bowl_consistency'] = np.nan
df_final['post_2012_bowl_pca'] = np.nan
for ind in df2.index :
  for ind2 in df_final.index :
    if(df_final['Players'][ind2]==df2['Name'][ind]):
      df_final['post_2012_hard_hit'][ind2] = 0.6*df2['hard_hit'][ind] + 0.4*df_final['post_2011_hard_hit'][ind2]
      df_final['post_2012_bat_consistency'][ind2] = 0.6*df2['bat_consistency'][ind] + 0.4*df_final['post_2011_bat_consistency'][ind2]
      df_final['post_2012_pca_bat'][ind2] = 0.6*df2['pca_bat'][ind] + 0.4*df_final['post_2011_pca_bat'][ind2]
      df_final['post_2012_Bowl_index'][ind2] = 0.6*df2['Bowl_index'][ind] + 0.4*df_final['post_2011_Bowl_index'][ind2]
      df_final['post_2012_bowl_consistency'][ind2] = 0.6*df2['bowl_consistency'][ind] + 0.4*df_final['post_2011_bowl_consistency'][ind2]
      df_final['post_2012_bowl_pca'][ind2] = 0.6*df2['bowl_pca'][ind] + 0.4*df_final['post_2011_bowl_pca'][ind2]
      break
 
df_final = df_final.fillna(0)

df_final['post_2013_hard_hit'] = np.nan
df_final['post_2013_bat_consistency'] = np.nan
df_final['post_2013_pca_bat'] = np.nan
df_final['post_2013_Bowl_index'] = np.nan
df_final['post_2013_bowl_consistency'] = np.nan
df_final['post_2013_bowl_pca'] = np.nan
for ind in df3.index :
  for ind2 in df_final.index :
    if(df_final['Players'][ind2]==df3['Name'][ind]):
      df_final['post_2013_hard_hit'][ind2] = 0.6*df3['hard_hit'][ind] + 0.4*df_final['post_2012_hard_hit'][ind2]
      df_final['post_2013_bat_consistency'][ind2] = 0.6*df3['bat_consistency'][ind] + 0.4*df_final['post_2012_bat_consistency'][ind2]
      df_final['post_2013_pca_bat'][ind2] = 0.6*df3['pca_bat'][ind] + 0.4*df_final['post_2012_pca_bat'][ind2]
      df_final['post_2013_Bowl_index'][ind2] = 0.6*df3['Bowl_index'][ind] + 0.4*df_final['post_2012_Bowl_index'][ind2]
      df_final['post_2013_bowl_consistency'][ind2] = 0.6*df3['bowl_consistency'][ind] + 0.4*df_final['post_2012_bowl_consistency'][ind2]
      df_final['post_2013_bowl_pca'][ind2] = 0.6*df3['bowl_pca'][ind] + 0.4*df_final['post_2012_bowl_pca'][ind2]
      break
 
df_final = df_final.fillna(0)

df_final['post_2014_hard_hit'] = np.nan
df_final['post_2014_bat_consistency'] = np.nan
df_final['post_2014_pca_bat'] = np.nan
df_final['post_2014_Bowl_index'] = np.nan
df_final['post_2014_bowl_consistency'] = np.nan
df_final['post_2014_bowl_pca'] = np.nan
for ind in df4.index :
  for ind2 in df_final.index :
    if(df_final['Players'][ind2]==df4['Name'][ind]):
      df_final['post_2014_hard_hit'][ind2] = 0.6*df4['hard_hit'][ind] + 0.4*df_final['post_2013_hard_hit'][ind2]
      df_final['post_2014_bat_consistency'][ind2] = 0.6*df4['bat_consistency'][ind] + 0.4*df_final['post_2013_bat_consistency'][ind2]
      df_final['post_2014_pca_bat'][ind2] = 0.6*df4['pca_bat'][ind] + 0.4*df_final['post_2013_pca_bat'][ind2]
      df_final['post_2014_Bowl_index'][ind2] = 0.6*df4['Bowl_index'][ind] + 0.4*df_final['post_2013_Bowl_index'][ind2]
      df_final['post_2014_bowl_consistency'][ind2] = 0.6*df4['bowl_consistency'][ind] + 0.4*df_final['post_2013_bowl_consistency'][ind2]
      df_final['post_2014_bowl_pca'][ind2] = 0.6*df4['bowl_pca'][ind] + 0.4*df_final['post_2013_bowl_pca'][ind2]
      break
 
df_final = df_final.fillna(0)

df_final['post_2015_hard_hit'] = np.nan
df_final['post_2015_bat_consistency'] = np.nan
df_final['post_2015_pca_bat'] = np.nan
df_final['post_2015_Bowl_index'] = np.nan
df_final['post_2015_bowl_consistency'] = np.nan
df_final['post_2015_bowl_pca'] = np.nan
for ind in df5.index :
  for ind2 in df_final.index :
    if(df_final['Players'][ind2]==df5['Name'][ind]):
      df_final['post_2015_hard_hit'][ind2] = 0.6*df5['hard_hit'][ind] + 0.4*df_final['post_2014_hard_hit'][ind2]
      df_final['post_2015_bat_consistency'][ind2] = 0.6*df5['bat_consistency'][ind] + 0.4*df_final['post_2014_bat_consistency'][ind2]
      df_final['post_2015_pca_bat'][ind2] = 0.6*df5['pca_bat'][ind] + 0.4*df_final['post_2014_pca_bat'][ind2]
      df_final['post_2015_Bowl_index'][ind2] = 0.6*df5['Bowl_index'][ind] + 0.4*df_final['post_2014_Bowl_index'][ind2]
      df_final['post_2015_bowl_consistency'][ind2] = 0.6*df5['bowl_consistency'][ind] + 0.4*df_final['post_2014_bowl_consistency'][ind2]
      df_final['post_2015_bowl_pca'][ind2] = 0.6*df5['bowl_pca'][ind] + 0.4*df_final['post_2014_bowl_pca'][ind2]
      break
 
df_final = df_final.fillna(0)

df_final['post_2016_hard_hit'] = np.nan
df_final['post_2016_bat_consistency'] = np.nan
df_final['post_2016_pca_bat'] = np.nan
df_final['post_2016_Bowl_index'] = np.nan
df_final['post_2016_bowl_consistency'] = np.nan
df_final['post_2016_bowl_pca'] = np.nan
for ind in df6.index :
  for ind2 in df_final.index :
    if(df_final['Players'][ind2]==df6['Name'][ind]):
      df_final['post_2016_hard_hit'][ind2] = 0.6*df6['hard_hit'][ind] + 0.4*df_final['post_2015_hard_hit'][ind2]
      df_final['post_2016_bat_consistency'][ind2] = 0.6*df6['bat_consistency'][ind] + 0.4*df_final['post_2015_bat_consistency'][ind2]
      df_final['post_2016_pca_bat'][ind2] = 0.6*df6['pca_bat'][ind] + 0.4*df_final['post_2015_pca_bat'][ind2]
      df_final['post_2016_Bowl_index'][ind2] = 0.6*df6['Bowl_index'][ind] + 0.4*df_final['post_2015_Bowl_index'][ind2]
      df_final['post_2016_bowl_consistency'][ind2] = 0.6*df6['bowl_consistency'][ind] + 0.4*df_final['post_2015_bowl_consistency'][ind2]
      df_final['post_2016_bowl_pca'][ind2] = 0.6*df6['bowl_pca'][ind] + 0.4*df_final['post_2015_bowl_pca'][ind2]
      break
 
df_final = df_final.fillna(0)

df_final['post_2017_hard_hit'] = np.nan
df_final['post_2017_bat_consistency'] = np.nan
df_final['post_2017_pca_bat'] = np.nan
df_final['post_2017_Bowl_index'] = np.nan
df_final['post_2017_bowl_consistency'] = np.nan
df_final['post_2017_bowl_pca'] = np.nan
for ind in df7.index :
  for ind2 in df_final.index :
    if(df_final['Players'][ind2]==df7['Name'][ind]):
      df_final['post_2017_hard_hit'][ind2] = 0.6*df7['hard_hit'][ind] + 0.4*df_final['post_2016_hard_hit'][ind2]
      df_final['post_2017_bat_consistency'][ind2] = 0.6*df7['bat_consistency'][ind] + 0.4*df_final['post_2016_bat_consistency'][ind2]
      df_final['post_2017_pca_bat'][ind2] = 0.6*df7['pca_bat'][ind] + 0.4*df_final['post_2016_pca_bat'][ind2]
      df_final['post_2017_Bowl_index'][ind2] = 0.6*df7['Bowl_index'][ind] + 0.4*df_final['post_2016_Bowl_index'][ind2]
      df_final['post_2017_bowl_consistency'][ind2] = 0.6*df7['bowl_consistency'][ind] + 0.4*df_final['post_2016_bowl_consistency'][ind2]
      df_final['post_2017_bowl_pca'][ind2] = 0.6*df7['bowl_pca'][ind] + 0.4*df_final['post_2016_bowl_pca'][ind2]
      break
 
df_final = df_final.fillna(0)

df_final['post_2018_hard_hit'] = np.nan
df_final['post_2018_bat_consistency'] = np.nan
df_final['post_2018_pca_bat'] = np.nan
df_final['post_2018_Bowl_index'] = np.nan
df_final['post_2018_bowl_consistency'] = np.nan
df_final['post_2018_bowl_pca'] = np.nan
for ind in df8.index :
  for ind2 in df_final.index :
    if(df_final['Players'][ind2]==df8['Name'][ind]):
      df_final['post_2018_hard_hit'][ind2] = 0.6*df8['hard_hit'][ind] + 0.4*df_final['post_2017_hard_hit'][ind2]
      df_final['post_2018_bat_consistency'][ind2] = 0.6*df8['bat_consistency'][ind] + 0.4*df_final['post_2017_bat_consistency'][ind2]
      df_final['post_2018_pca_bat'][ind2] = 0.6*df8['pca_bat'][ind] + 0.4*df_final['post_2017_pca_bat'][ind2]
      df_final['post_2018_Bowl_index'][ind2] = 0.6*df8['Bowl_index'][ind] + 0.4*df_final['post_2017_Bowl_index'][ind2]
      df_final['post_2018_bowl_consistency'][ind2] = 0.6*df8['bowl_consistency'][ind] + 0.4*df_final['post_2017_bowl_consistency'][ind2]
      df_final['post_2018_bowl_pca'][ind2] = 0.6*df8['bowl_pca'][ind] + 0.4*df_final['post_2017_bowl_pca'][ind2]
      break
 
df_final = df_final.fillna(0)

df_final

df_final.to_excel('player_stats_final.xlsx')

from google.colab import files
files.download('player_stats_final.xlsx')