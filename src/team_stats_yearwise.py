# -*- coding: utf-8 -*-
"""Team_stats_yearwise.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1yvyMtjNb5thZjZqo6nkiWBHe0ngrKHVh
"""

from google.colab import drive
drive.mount('/content/gdrive')

import numpy as np
import pandas as pd

df = pd.read_csv('/content/gdrive/My Drive/IPL_data/IPL_data/2018_matches.csv')
df = df.append(pd.read_csv('/content/gdrive/My Drive/IPL_data/IPL_data/2011_matches.csv'),ignore_index=True)
df = df.append(pd.read_csv('/content/gdrive/My Drive/IPL_data/IPL_data/2012_matches.csv'),ignore_index=True)
df = df.append(pd.read_csv('/content/gdrive/My Drive/IPL_data/IPL_data/2013_matches.csv'),ignore_index=True)
df = df.append(pd.read_csv('/content/gdrive/My Drive/IPL_data/IPL_data/2014_matches.csv'),ignore_index=True)
df = df.append(pd.read_csv('/content/gdrive/My Drive/IPL_data/IPL_data/2015_matches.csv'),ignore_index=True)
df = df.append(pd.read_csv('/content/gdrive/My Drive/IPL_data/IPL_data/2016_matches.csv'),ignore_index=True)
df = df.append(pd.read_csv('/content/gdrive/My Drive/IPL_data/IPL_data/2017_matches.csv'),ignore_index=True)
df = df.append(pd.read_csv('/content/gdrive/My Drive/IPL_data/IPL_data/2018_matches.csv'),ignore_index=True)

arr9 = np.array(df['team_1'].unique())

df = df.append(pd.read_csv('/content/gdrive/My Drive/IPL_data/IPL_data/2011_matches.csv'),ignore_index=True)

df = df.drop(['url'],axis=1)

df2 = pd.DataFrame(data = arr9,columns = ['Teams'])

df['loser'] = np.nan
for ind in df.index :
  if (df['winner'][ind]==df['team_1'][ind]) :
    df['loser'][ind] = df['team_2'][ind]
  else :
    df['loser'][ind] = df['team_1'][ind]

arr = []
arr.append(df[df['winner']=='Chennai Super Kings'].shape[0])
arr.append(df[df['winner']=='Delhi Daredevils'].shape[0])
arr.append(df[df['winner']=='Mumbai Indians'].shape[0])
arr.append(df[df['winner']=='Kings XI Punjab'].shape[0])
arr.append(df[df['winner']=='Kolkata Knight Riders'].shape[0])
arr.append(df[df['winner']=='Rajasthan Royals'].shape[0])
arr.append(df[df['winner']=='Royal Challengers Bangalore'].shape[0])
arr.append(df[df['winner']=='Deccan Chargers'].shape[0])
arr.append(df[df['winner']=='Pune Warriors'].shape[0])
arr.append(df[df['winner']=='Sunrisers Hyderabad'].shape[0])
arr.append(df[df['winner']=='Gujarat Lions'].shape[0])
arr.append(df[df['winner']=='Rising Pune Supergiants'].shape[0])
arr.append(df[df['winner']=='Rising Pune Supergiant'].shape[0])

       
arr

df2.insert(1,"2011_Wins",arr,True)

arr2 = []
arr2.append(df[df['loser']=='Chennai Super Kings'].shape[0])
arr2.append(df[df['loser']=='Delhi Daredevils'].shape[0])
arr2.append(df[df['loser']=='Mumbai Indians'].shape[0])
arr2.append(df[df['loser']=='Kings XI Punjab'].shape[0])
arr2.append(df[df['loser']=='Kolkata Knight Riders'].shape[0])
arr2.append(df[df['loser']=='Rajasthan Royals'].shape[0])
arr2.append(df[df['loser']=='Royal Challengers Bangalore'].shape[0])
arr2.append(df[df['loser']=='Deccan Chargers'].shape[0])
arr2.append(df[df['loser']=='Pune Warriors'].shape[0])
arr2.append(df[df['loser']=='Sunrisers Hyderabad'].shape[0])
arr2.append(df[df['loser']=='Gujarat Lions'].shape[0])
arr2.append(df[df['loser']=='Rising Pune Supergiants'].shape[0])
arr2.append(df[df['loser']=='Rising Pune Supergiant'].shape[0])

arr2

df2.insert(2,"2011_Losses",arr2,True)
df2

df2['2011_Win percentage'] = df2['2011_Wins'] / (df2['2011_Wins'] + df2['2011_Losses'])

df['toss_and_match_won'] = df['toss_winner']==df['winner']

arr = []
arr.append(df[(df['toss_winner']=='Chennai Super Kings') & (df['toss_and_match_won']==True)].shape[0])
arr.append(df[(df['toss_winner']=='Delhi Daredevils') & (df['toss_and_match_won']==True)].shape[0])
arr.append(df[(df['toss_winner']=='Mumbai Indians') & (df['toss_and_match_won']==True)].shape[0])
arr.append(df[(df['toss_winner']=='Kings XI Punjab') & (df['toss_and_match_won']==True)].shape[0])
arr.append(df[(df['toss_winner']=='Kolkata Knight Riders') & (df['toss_and_match_won']==True)].shape[0])
arr.append(df[(df['toss_winner']=='Rajasthan Royals') & (df['toss_and_match_won']==True)].shape[0])
arr.append(df[(df['toss_winner']=='Royal Challengers Bangalore') & (df['toss_and_match_won']==True)].shape[0])
arr.append(df[(df['toss_winner']=='Deccan Chargers') & (df['toss_and_match_won']==True)].shape[0])
arr.append(df[(df['toss_winner']=='Pune Warriors') & (df['toss_and_match_won']==True)].shape[0])
arr.append(df[(df['toss_winner']=='Sunrisers Hyderabad') & (df['toss_and_match_won']==True)].shape[0])
arr.append(df[(df['toss_winner']=='Gujarat Lions') & (df['toss_and_match_won']==True)].shape[0])
arr.append(df[(df['toss_winner']=='Rising Pune Supergiants') & (df['toss_and_match_won']==True)].shape[0])
arr.append(df[(df['toss_winner']=='Rising Pune Supergiant') & (df['toss_and_match_won']==True)].shape[0])
arr
df2.insert(3,"2011_match_won_given_toss_won",arr,True)

arr = []
arr.append(df[(df['toss_winner']=='Chennai Super Kings') & (df['toss_and_match_won']==False)].shape[0])
arr.append(df[(df['toss_winner']=='Delhi Daredevils') & (df['toss_and_match_won']==False)].shape[0])
arr.append(df[(df['toss_winner']=='Mumbai Indians') & (df['toss_and_match_won']==False)].shape[0])
arr.append(df[(df['toss_winner']=='Kings XI Punjab') & (df['toss_and_match_won']==False)].shape[0])
arr.append(df[(df['toss_winner']=='Kolkata Knight Riders') & (df['toss_and_match_won']==False)].shape[0])
arr.append(df[(df['toss_winner']=='Rajasthan Royals') & (df['toss_and_match_won']==False)].shape[0])
arr.append(df[(df['toss_winner']=='Royal Challengers Bangalore') & (df['toss_and_match_won']==False)].shape[0])
arr.append(df[(df['toss_winner']=='Deccan Chargers') & (df['toss_and_match_won']==False)].shape[0])
arr.append(df[(df['toss_winner']=='Pune Warriors') & (df['toss_and_match_won']==False)].shape[0])
arr.append(df[(df['toss_winner']=='Sunrisers Hyderabad') & (df['toss_and_match_won']==False)].shape[0])
arr.append(df[(df['toss_winner']=='Gujarat Lions') & (df['toss_and_match_won']==False)].shape[0])
arr.append(df[(df['toss_winner']=='Rising Pune Supergiants') & (df['toss_and_match_won']==False)].shape[0])
arr.append(df[(df['toss_winner']=='Rising Pune Supergiant') & (df['toss_and_match_won']==False)].shape[0])

arr
df2.insert(4,"2011_match_lost_given_toss_won",arr,True)

df2['2010_Won_When_Toss_Won_Percentage'] = df2['2011_match_won_given_toss_won'] / (df2['2011_match_won_given_toss_won'] + df2['2011_match_lost_given_toss_won'])

df2['2011_Won_When_Toss_Lost_Percentage'] = (df2['2011_Wins']-df2['2011_match_won_given_toss_won']) / (df2['2011_Wins'] - df2['2011_match_won_given_toss_won'] + df2['2011_Losses'] - df2['2011_match_lost_given_toss_won'])

df['Batting_First'] = np.nan
for ind in df.index :
  if (df['toss_winner'][ind]==df['team_1'][ind] and df['winner_choice'][ind]=='Bat'):
    df['Batting_First'][ind] = df['team_1'][ind]
  elif (df['toss_winner'][ind]!=df['team_1'][ind] and df['winner_choice'][ind]!='Bat') :
    df['Batting_First'][ind] = df['team_1'][ind]
  else :
    df['Batting_First'][ind] = df['team_2'][ind]

arr = []
arr.append(df[(df['winner']=='Chennai Super Kings') & (df['Batting_First']==df['winner'])].shape[0])
arr.append(df[(df['winner']=='Delhi Daredevils') & (df['Batting_First']==df['winner'])].shape[0])
arr.append(df[(df['winner']=='Mumbai Indians') & (df['Batting_First']==df['winner'])].shape[0])
arr.append(df[(df['winner']=='Kings XI Punjab') & (df['Batting_First']==df['winner'])].shape[0])
arr.append(df[(df['winner']=='Kolkata Knight Riders') & (df['Batting_First']==df['winner'])].shape[0])
arr.append(df[(df['winner']=='Rajasthan Royals') & (df['Batting_First']==df['winner'])].shape[0])
arr.append(df[(df['winner']=='Royal Challengers Bangalore') & (df['Batting_First']==df['winner'])].shape[0])
arr.append(df[(df['winner']=='Deccan Chargers') & (df['Batting_First']==df['winner'])].shape[0])
arr.append(df[(df['winner']=='Pune Warriors')  & (df['Batting_First']==df['winner'])].shape[0])
arr.append(df[(df['winner']=='Sunrisers Hyderabad')  & (df['Batting_First']==df['winner'])].shape[0])
arr.append(df[(df['winner']=='Gujarat Lions') & (df['Batting_First']==df['winner'])].shape[0])
arr.append(df[(df['winner']=='Rising Pune Supergiants') & (df['Batting_First']==df['winner'])].shape[0])
arr.append(df[(df['winner']=='Rising Pune Supergiant')  & (df['Batting_First']==df['winner'])].shape[0])

arr
df2.insert(5,"2011_won_batting_first",arr,True)

arr = []
arr.append(df[(df['Batting_First']=='Chennai Super Kings') & (df['Batting_First']!=df['winner'])].shape[0])
arr.append(df[(df['Batting_First']=='Delhi Daredevils') & (df['Batting_First']!=df['winner'])].shape[0])
arr.append(df[(df['Batting_First']=='Mumbai Indians') & (df['Batting_First']!=df['winner'])].shape[0])
arr.append(df[(df['Batting_First']=='Kings XI Punjab') & (df['Batting_First']!=df['winner'])].shape[0])
arr.append(df[(df['Batting_First']=='Kolkata Knight Riders') & (df['Batting_First']!=df['winner'])].shape[0])
arr.append(df[(df['Batting_First']=='Rajasthan Royals') & (df['Batting_First']!=df['winner'])].shape[0])
arr.append(df[(df['Batting_First']=='Royal Challengers Bangalore') & (df['Batting_First']!=df['winner'])].shape[0])
arr.append(df[(df['Batting_First']=='Deccan Chargers') & (df['Batting_First']!=df['winner'])].shape[0])
arr.append(df[(df['Batting_First']=='Pune Warriors')  & (df['Batting_First']!=df['winner'])].shape[0])
arr.append(df[(df['Batting_First']=='Sunrisers Hyderabad')  & (df['Batting_First']!=df['winner'])].shape[0])
arr.append(df[(df['Batting_First']=='Gujarat Lions') & (df['Batting_First']!=df['winner'])].shape[0])
arr.append(df[(df['Batting_First']=='Rising Pune Supergiants') & (df['Batting_First']!=df['winner'])].shape[0])
arr.append(df[(df['Batting_First']=='Rising Pune Supergiant')  & (df['Batting_First']!=df['winner'])].shape[0])

arr
df2.insert(5,"2011_lost_batting_first",arr,True)

df2['2011_Won_Batting_First_Percentage'] = df2['2011_won_batting_first'] / (df2['2011_won_batting_first'] + df2['2011_lost_batting_first'])

df2['2011_Won_Chasing_Percentage'] = (df2['2011_Wins'] - df2['2011_won_batting_first'])/ (df2['2011_Wins']-df2['2011_won_batting_first'] + df2['2011_Losses']-df2['2011_lost_batting_first'])

df2.columns

#df2.rename(columns={'2017_Wins':'2018_Wins', 
#                  '2017_Losses':'2018_Losses',
#                  '2017_match_won_given_toss_won' : '2018_match_won_given_toss_won',
#      '2017_match_lost_given_toss_won' : '2018_match_lost_given_toss_won',
#      '2017_lost_batting_first' : '2018_lost_batting_first',
#      '2017_won_batting_first' : '2018_won_batting_first',
#      '2017_Win percentage' : '2018_Win_percentage',
#      '2017_Won_When_Toss_Won_Percentage' : '2018_Won_When_Toss_Won_Percentage',
#      '2017_Won_When_Toss_Lost_Percentage' : '2018_Won_When_Toss_Lost_Percentage',
#      '2017_Won_Batting_First_Percentage' : '2018_Won_Batting_First_Percentage',
#      '2017_Won_Chasing_Percentage' : '2018_Won_Chasing_Percentage'},inplace=True)

df2.columns

df2.to_excel('team_stats_2011.xlsx')

from google.colab import files
files.download('team_stats_2011.xlsx')

df8

df9

